# UI 组件演示

## 新增 AI 交互组件展示

本文档展示新增的三个核心 UI 组件的外观和功能。

## 1. ThinkingProcess 组件

### 组件结构

```
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ 🧠 AI 思考过程            ▼        3 步  ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                          ┃
┃  ① 分析玩家意图                          ┃
┃    根据输入"探索洞穴"判断这是一个        ┃
┃    探索类行动                            ┃
┃                                          ┃
┃  ② 检查游戏状态                          ┃
┃    需要获取玩家当前位置和属性            ┃
┃                                          ┃
┃  ✓ 规划响应策略                          ┃
┃    先调用 get_player_state，再调用       ┃
┃    roll_check 进行探索检定               ┃
┃                                          ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

### 状态展示

**正在思考:**
```
┃  ⟳ 正在思考...                          ┃
```

**思考中的步骤:**
```
┃  ⟳ 评估工具选项                         ┃  <- 蓝色背景，动画
┃    正在分析需要哪些工具...               ┃
```

**已完成的步骤:**
```
┃  ✓ 分析玩家意图           14:23:45       ┃  <- 绿色勾选
┃    根据输入判断...                       ┃
```

**待处理的步骤:**
```
┃  ○ 生成最终输出                         ┃  <- 灰色，半透明
┃    等待前序步骤完成                     ┃
```

### 折叠状态

```
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ 🧠 AI 思考过程            ▶        3 步  ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

---

## 2. SuggestionChips 组件

### 组件结构

```
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ ✨ AI 建议                       🔄       ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                          ┃
┃  ╭─────────────────╮  ╭──────────────╮  ┃
┃  │ 🗺️ 探索周围环境 →│  │ ⚔️ 准备战斗 →│  ┃
┃  ╰─────────────────╯  ╰──────────────╯  ┃
┃                                          ┃
┃  ╭─────────────╮  ╭────────────────╮    ┃
┃  │ ❓ 询问NPC →│  │ ✨ 使用魔法物品 →│    ┃
┃  ╰─────────────╯  ╰────────────────╯    ┃
┃                                          ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

### 建议类型和颜色

**探索类 (explore)** - 蓝色
```
╭─────────────────╮
│ 🗺️ 探索周围环境 →│  <- 蓝色边框和文字
╰─────────────────╯
```

**行动类 (action)** - 红色
```
╭──────────────╮
│ ⚔️ 准备战斗 →│  <- 红色边框和文字
╰──────────────╯
```

**问题类 (question)** - 紫色
```
╭─────────────╮
│ ❓ 询问NPC →│  <- 紫色边框和文字
╰─────────────╯
```

**创意类 (creative)** - 绿色
```
╭────────────────╮
│ ✨ 使用魔法物品 →│  <- 绿色边框和文字
╰────────────────╯
```

### 交互效果

**悬停状态:**
```
╭─────────────────╮
│ 🗺️ 探索周围环境 →│  <- 背景变深，轻微放大
╰─────────────────╯
```

**点击效果:**
```
╭─────────────────╮
│ 🗺️ 探索周围环境 →│  <- 轻微缩小，然后填充到输入框
╰─────────────────╯
```

---

## 3. TaskProgress 组件

### 组件结构

```
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ AI 工作进度                    2 / 4     ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃ ▓▓▓▓▓▓▓▓▓▓░░░░░░░░░░             50%    ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                          ┃
┃  ✓ 工具调用: get_player_state            ┃
┃    💻 src/game/tools.py:42               ┃
┃                        14:23:45          ┃
┃                                          ┃
┃  ⟳ 工具调用: roll_check                  ┃
┃    💻 正在执行技能检定...                 ┃
┃    ▓▓▓▓░░░░░░░░ 30%                      ┃
┃                        14:23:47          ┃
┃                                          ┃
┃  ○ 生成场景描述                          ┃
┃    📝 等待工具调用完成                   ┃
┃                                          ┃
┃  ○ 更新游戏状态                          ┃
┃    📄 data/game_state.json               ┃
┃                                          ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

### 任务状态

**待处理 (pending)** - 灰色
```
┃  ○ 生成场景描述                          ┃
┃    📝 等待工具调用完成                   ┃
```

**进行中 (in_progress)** - 蓝色
```
┃  ⟳ 工具调用: roll_check                  ┃  <- 蓝色背景
┃    💻 正在执行技能检定...                 ┃  <- 旋转图标
┃    ▓▓▓▓░░░░░░░░ 30%                      ┃  <- 进度条
```

**已完成 (completed)** - 绿色
```
┃  ✓ 工具调用: get_player_state            ┃  <- 绿色背景
┃    💻 src/game/tools.py:42               ┃  <- 绿色勾选
```

**错误 (error)** - 红色
```
┃  ✗ 工具调用: update_hp                   ┃  <- 红色背景
┃    ⚠️ 错误: HP 值不能为负数                ┃  <- 错误信息
```

### 任务类型图标

```
📄 file   - 文件操作
💻 code   - 代码生成
📝 text   - 文本处理
⭕ other  - 其他任务
```

---

## 完整界面布局

### 聊天界面整体布局

```
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                      DM 聊天界面                         ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃ ┌────────────────────────────────────────────────────┐ ┃
┃ │ 🧠 AI 思考过程                        ▼      3 步  │ ┃
┃ ├────────────────────────────────────────────────────┤ ┃
┃ │  ① 分析玩家意图                                    │ ┃
┃ │     根据输入判断这是一个探索类行动...              │ ┃
┃ │  ② 检查游戏状态                                    │ ┃
┃ │     需要获取玩家当前位置...                        │ ┃
┃ │  ✓ 规划响应策略                                    │ ┃
┃ │     先调用 get_player_state...                     │ ┃
┃ └────────────────────────────────────────────────────┘ ┃
┃                                                          ┃
┃ ┌────────────────────────────────────────────────────┐ ┃
┃ │ AI 工作进度                          2 / 2         │ ┃
┃ ├────────────────────────────────────────────────────┤ ┃
┃ │ ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓              100%            │ ┃
┃ ├────────────────────────────────────────────────────┤ ┃
┃ │  ✓ 工具调用: get_player_state                      │ ┃
┃ │  ✓ 工具调用: roll_check                            │ ┃
┃ └────────────────────────────────────────────────────┘ ┃
┃                                                          ┃
┃ ┌────────────────────────────────────────────────────┐ ┃
┃ │ [玩家] 14:23:40                                     │ ┃
┃ │ 我想探索这个洞穴                                    │ ┃
┃ └────────────────────────────────────────────────────┘ ┃
┃                                                          ┃
┃ ┌────────────────────────────────────────────────────┐ ┃
┃ │ [DM] 14:23:45                                       │ ┃
┃ │ 你小心翼翼地走进洞穴。潮湿的空气中弥漫着霉味，     │ ┃
┃ │ 远处传来滴水声。你的眼睛逐渐适应黑暗...            │ ┃
┃ │                                                     │ ┃
┃ │ 【检定成功！】你发现了一条隐藏的通道。              │ ┃
┃ └────────────────────────────────────────────────────┘ ┃
┃                                                          ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃ ┌────────────────────────────────────────────────────┐ ┃
┃ │ ✨ AI 建议                                     🔄  │ ┃
┃ ├────────────────────────────────────────────────────┤ ┃
┃ │ 🗺️ 探索隐藏通道 → ⚔️ 准备应对危险 → ❓ 仔细观察 →  │ ┃
┃ └────────────────────────────────────────────────────┘ ┃
┃                                                          ┃
┃ ┌────────────────────────────────────────────┬────────┐ ┃
┃ │ 输入你的行动...                            │  发送  │ ┃
┃ │ (Shift+Enter 换行)                         │   ↑   │ ┃
┃ └────────────────────────────────────────────┴────────┘ ┃
┃ ● WebSocket 已连接                                      ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

---

## 颜色主题

### 亮色模式

```
思考过程:
- 背景: 紫蓝渐变 (purple-50 → blue-50)
- 边框: 紫色 (purple-200)
- 文字: 深紫色 (purple-700)

建议芯片:
- 探索: 蓝色系 (blue-500/10 背景, blue-700 文字)
- 行动: 红色系 (red-500/10 背景, red-700 文字)
- 问题: 紫色系 (purple-500/10 背景, purple-700 文字)
- 创意: 绿色系 (green-500/10 背景, green-700 文字)

任务进度:
- 进行中: 蓝色系 (blue-50 背景, blue-500 图标)
- 已完成: 绿色系 (green-50 背景, green-500 图标)
- 错误: 红色系 (red-50 背景, red-500 图标)
```

### 暗色模式

```
思考过程:
- 背景: 紫蓝渐变 (purple-950/20 → blue-950/20)
- 边框: 紫色 (purple-800)
- 文字: 浅紫色 (purple-300)

建议芯片:
- 探索: 蓝色系 (blue-500/10 背景, blue-300 文字)
- 行动: 红色系 (red-500/10 背景, red-300 文字)
- 问题: 紫色系 (purple-500/10 背景, purple-300 文字)
- 创意: 绿色系 (green-500/10 背景, green-300 文字)

任务进度:
- 进行中: 蓝色系 (blue-950/20 背景, blue-400 图标)
- 已完成: 绿色系 (green-950/20 背景, green-400 图标)
- 错误: 红色系 (red-950/20 背景, red-400 图标)
```

---

## 动画效果

### 思考步骤动画

```css
/* 正在思考的步骤 */
.thinking-active {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  background: linear-gradient(90deg, #ddd6fe, #bfdbfe, #ddd6fe);
  background-size: 200% 100%;
  animation: shimmer 2s infinite;
}

/* 完成时的弹入效果 */
.thinking-completed {
  animation: fadeInUp 0.3s ease-out;
}
```

### 建议芯片动画

```css
/* 悬停放大 */
.chip:hover {
  transform: scale(1.05);
  transition: transform 0.2s ease;
}

/* 点击缩小 */
.chip:active {
  transform: scale(0.95);
  transition: transform 0.1s ease;
}
```

### 任务进度动画

```css
/* 进度条填充 */
.progress-bar {
  transition: width 0.5s ease-out;
}

/* 旋转图标 */
.spinner {
  animation: spin 1s linear infinite;
}

/* 完成勾选弹入 */
.checkmark {
  animation: checkmark 0.4s ease-out;
}
```

---

## 响应式设计

### 桌面端 (>768px)

```
┌──────────────────────────────────────┐
│ 思考过程（展开）                      │
│ 任务进度（展开）                      │
│ 聊天消息                             │
│ 建议芯片（多行）                      │
│ 输入框                               │
└──────────────────────────────────────┘
```

### 移动端 (<768px)

```
┌────────────────┐
│ 思考过程（折叠）│
│ 任务进度（折叠）│
│ 聊天消息        │
│ 建议芯片（滚动）│
│ 输入框          │
└────────────────┘
```

---

## 使用示例

### TypeScript 类型定义

```typescript
// 思考步骤
interface ThinkingStep {
  id: string;
  title: string;
  content: string;
  status: 'thinking' | 'completed' | 'pending';
  timestamp?: number;
}

// 建议芯片
interface Suggestion {
  id: string;
  text: string;
  category?: 'explore' | 'action' | 'question' | 'creative';
  icon?: string;
}

// 任务
interface Task {
  id: string;
  title: string;
  description?: string;
  status: 'pending' | 'in_progress' | 'completed' | 'error';
  type?: 'file' | 'code' | 'text' | 'other';
  fileReference?: string;
  progress?: number;
  error?: string;
  timestamp?: number;
}
```

### React 使用示例

```tsx
// 导入组件
import { ThinkingProcess } from '@/components/chat/ThinkingProcess';
import { SuggestionChips } from '@/components/chat/SuggestionChips';
import { TaskProgress } from '@/components/chat/TaskProgress';

// 在组件中使用
function ChatInterface() {
  const [thinkingSteps, setThinkingSteps] = useState<ThinkingStep[]>([]);
  const [suggestions, setSuggestions] = useState<Suggestion[]>([]);
  const [tasks, setTasks] = useState<Task[]>([]);

  return (
    <>
      <ThinkingProcess steps={thinkingSteps} isThinking={true} />
      <TaskProgress tasks={tasks} />
      <SuggestionChips suggestions={suggestions} onSelect={handleSelect} />
    </>
  );
}
```

---

## 相关文档

- [AI 思考过程可视化 UI](./AI_THINKING_UI.md)
- [Kimi K2 集成指南](./KIMI_K2_INTEGRATION.md)
- [shadcn/ui 组件文档](https://ui.shadcn.com/)
