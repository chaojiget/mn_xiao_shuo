# 已迁移：请使用主 README 的“快速开始”

此文档对应的是旧的 CLI/交互式小说生成流程。当前项目的标准启动方式如下：

- `README.md` → 快速开始（后端 + 前端）
- `docs/WORLDPACK_QUICKSTART.md` → 预生成世界（WorldPack）
- `docs/implementation/PHASE2_API_ENDPOINTS.md` → 游戏 API 端点

以下内容保留作历史参考。

### 步骤 2: 初始化数据库

```bash
# 初始化 SQLite 数据库
python scripts/init_db.py
```

预期输出:
```
============================================================
初始化 SQLite 数据库
============================================================

数据库路径: ./data/sqlite/novel.db

正在创建数据库表...
✅ 数据库表创建成功

创建的表 (10 个):
  - chapters
  - characters
  - clues
  - evidence
  - event_arcs
  - event_nodes
  - execution_logs
  - novels
  - setup_debts
  - world_states

============================================================
✅ 数据库初始化完成!
============================================================
```

### 步骤 3: 测试数据库 (可选)

```bash
# 运行数据库测试
python test_database.py
```

### 步骤 4: 启动交互式小说生成器

```bash
# 运行交互式生成器
python interactive_generator.py
```

---

## 📖 使用交互式生成器

### 启动流程

1. **选择小说类型**:
   ```
   选择小说类型:
   1. 科幻小说 (能源纪元)
   2. 玄幻小说 (逆天改命录)

   请选择 (1/2): 1
   ```

2. **自动生成第一章**:
   系统会自动生成第一章内容(800-1200字)

3. **交互选择**:
   ```
   你的选择:
   >
   ```

   你可以:
   - **输入选择**: 例如 "向导师陈教授报告" (影响后续剧情)
   - **直接回车**: 自动继续生成
   - **输入 'save'**: 查看统计信息
   - **输入 'quit'**: 退出生成

4. **重复生成**:
   系统会根据你的选择继续生成后续章节

5. **导出小说**:
   ```
   是否导出小说? (y/n): y
   ✅ 小说已导出到: output_novel_xxx.md
   ```

---

## 🎮 交互示例

### 示例 1: 科幻小说 - 能源纪元

```
============================================================
第 1 章
============================================================

2157年3月15日，火星大学能源研究中心。

林墨盯着全息屏幕上滚动的数据，眉头越皱越紧。作为能源工程师，
他已经审计木卫二的产量数据三天了，但眼前的异常让他不安...

(省略800字)

...林墨深吸一口气，这个发现可能会改变一切。

============================================================

你的选择:
> 向导师陈教授报告
✅ 已记录你的选择: 向导师陈教授报告

============================================================
正在生成第 2 章...
============================================================

(第2章会基于你的选择生成...)
```

### 示例 2: 玄幻小说 - 逆天改命录

```
============================================================
第 1 章
============================================================

青云宗外门，破旧的修炼室内。

云枫盘膝而坐，手中的古老玉简散发着微弱的光芒。五灵根资质，
在修仙界几乎是废材的代名词，但这块意外得到的玉简...

(省略800字)

...云枫知道，他的命运即将改变。

============================================================

你的选择:
> 尝试修炼逆天诀
✅ 已记录你的选择: 尝试修炼逆天诀
```

---

## 🎯 功能说明（历史版本）

### 自动化功能

- ✅ **智能剧情推进**: 基于设定和前情自动生成连贯剧情
- ✅ **人物状态管理**: 自动跟踪主角属性和资源
- ✅ **世界状态保存**: 每章自动保存状态到数据库
- ✅ **多模型支持**: 自动选择合适的模型(节省成本)

### 交互功能

- 🎮 **玩家选择**: 输入选择影响剧情走向
- 💾 **实时保存**: 所有内容保存到 SQLite 数据库
- 📊 **统计信息**: 随时查看生成进度
- 📤 **导出小说**: Markdown 格式导出

---

## 💰 成本估算

### 生成 10 章小说

**使用 Claude Sonnet 4.5:**
- 第 1 章: ~$0.15 (高质量开篇)
- 后续 9 章: 自动切换到 DeepSeek
- 总成本: **~$0.30**

**生成 100 章:**
- 约 **$3-5** (混合使用 Claude + DeepSeek)

---

## 🔧 高级选项

### 修改模型选择策略

编辑 `interactive_generator.py` 第 95 行:

```python
# 默认策略: 首章用 Claude Sonnet, 后续用 DeepSeek
model = "claude-sonnet" if chapter_num == 1 else "deepseek"

# 全部使用 Claude Sonnet (高质量,贵)
model = "claude-sonnet"

# 全部使用 DeepSeek (性价比高,中文好)
model = "deepseek"

# 全部使用 Qwen (中文优化)
model = "qwen"
```

### 修改章节长度

编辑提示词模板 (第 139 行):

```python
# 默认: 800-1200字
prompt += """
【输出要求】
1. 字数: 800-1200字
...
"""

# 改为更长的章节
prompt += """
【输出要求】
1. 字数: 2000-3000字
...
"""
```

---

## 📁 生成的文件位置

### 数据库
- **路径**: `./data/sqlite/novel.db`
- **查看**: 使用 SQLite 浏览器 或 `sqlite3 data/sqlite/novel.db`

### 导出的小说
- **格式**: Markdown (.md)
- **路径**: `./output_novel_xxx.md`
- **命名**: 自动生成唯一ID

---

## 🐛 常见问题

### Q1: 数据库错误?

```bash
# 重新初始化数据库
rm -f data/sqlite/novel.db
python scripts/init_db.py
```

### Q2: API 调用失败?

检查 `.env` 文件中的 `OPENROUTER_API_KEY` 是否正确。

### Q3: 生成内容质量不好?

- 尝试使用 `claude-sonnet` 模型
- 修改 temperature (降低到 0.6-0.7)
- 丰富设定文件中的内容

### Q4: 想从中断的地方继续?

当前版本暂不支持断点续写,后续会添加此功能。

---

## 📝 下一步

1. **运行测试**: 生成 3-5 章测试内容
2. **自定义设定**: 修改 `examples/` 中的 JSON 文件
3. **开发 Global Director**: 参考 `NEXT_STEPS.md`

---

## 🎉 开始你的小说之旅!

```bash
# 一键启动
python interactive_generator.py
```

祝创作愉快! 📚✨
